<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menú Administrador</title>
    <link rel="stylesheet" href="/css/login.css">
    <link rel="stylesheet" href="/css/menu-admin.css">
    <!-- Styles moved to /css/menu-admin.css -->
</head>
<body class="admin">
    <div class="header">
        <h1>Panel de Administrador</h1>
        <div class="user-info">
            Bienvenido, <span id="nombreUsuario"></span>
        </div>
    </div>
    <!-- Nueva sección con tres paneles para funciones administrativas (solo visual) -->
    <div class="admin-sections">
        <div class="admin-section menu-item">
            <div class="section-header"><h3>Emular tránsito</h3></div>
            <div class="section-body">
                <p>Simula el paso de un vehículo por un peaje.</p>
                <form>
                    <label>Matrícula</label>
                        <input type="text" placeholder="ABC1234">

                    <label>Peaje</label>
                        <select id="peajeSelect">
                        <!-- Options loaded dynamically -->
                        </select>

                    <label>Categoría</label>
                        <select>
                        <option>Automóvil</option>
                        <option>Moto</option>
                        </select>

                        <div class="action-row">
                            <button class="action-btn">Emular</button>
                        </div>
                </form>
            </div>
        </div>

        <div class="admin-section menu-item">
            <div class="section-header"><h3>Asignar bonificaciones</h3></div>
            <div class="section-body">
                <p>Asignar bonificaciones a un propietario o vehículo.</p>
                <form>
                    <label>Propietario (cédula)</label>
                        <input type="text" placeholder="11111111">

                    <label>Tipo de bonificación</label>
                        <select>
                        <option>Descuento por pago anticipado</option>
                        <option>Promoción</option>
                        </select>

                    <label>Monto/Porcentaje</label>
                        <input type="text" placeholder="10% / $100">

                        <div class="action-row">
                            <button class="action-btn">Asignar</button>
                        </div>
                </form>
            </div>
        </div>

        <div class="admin-section menu-item">
            <div class="section-header"><h3>Cambiar estado del propietario</h3></div>
            <div class="section-body">
                <p>Modificar el estado actual</p>
                <form>
                    <label>Propietario (cédula)</label>
                        <input type="text" placeholder="1">

                    <label>Estado</label>
                        <select>
                        <option>Habilitado</option>
                        <option>Penalizado</option>
                        <option>Suspendido</option>
                        <option>Deshabilitado</option>
                        </select>

                        <div class="action-row">
                            <button class="action-btn">Cambiar estado</button>
                        </div>
                </form>
            </div>
        </div>
    </div>

    <script src="/utilesVista.js"></script>
    <script src="/vistaWeb.js"></script>
    <script>
        // Inicialización de la vista
        document.addEventListener('DOMContentLoaded', function() {
            // Configurar la URL para iniciar la vista
            urlIniciarVista = "/acceso/iniciarAdministrador";
            
            // Manejar cierre de sesión cuando se cierra la ventana
            urlCierreVista = "/acceso/cerrarSesion";

            // Cargar lista de puestos para el select de Emular tránsito
            cargarPuestos();
        });

        // Cargar puestos desde el backend y poblar el select
        async function cargarPuestos() {
            try {
                const resp = await fetch('/puestos/listar');
                if (!resp.ok) throw new Error('Error al obtener puestos');
                const lista = await resp.json();
                const sel = document.getElementById('peajeSelect');
                if (!sel) return;
                sel.innerHTML = '';
                lista.forEach(nombre => {
                    const opt = document.createElement('option');
                    opt.value = nombre;
                    opt.textContent = nombre;
                    sel.appendChild(opt);
                });
            } catch (e) {
                console.error('No se pudieron cargar los puestos:', e);
            }
        }

        // Función para mostrar datos del usuario
        function mostrar_datosUsuario(datos) {
            document.getElementById('nombreUsuario').textContent = datos.nombre + " " + datos.apellido;
        }
    </script>
</body>
</html>